import { EINVAL, ENOSYS, ESUCCESS } from "../errno.js";
import { writeUint64 } from "../util/write-uint64.js";
import { InstantiatedWasm } from "../wasm.js";
export var ClockId;
(function (ClockId) {
    ClockId[ClockId["REALTIME"] = 0] = "REALTIME";
    ClockId[ClockId["MONOTONIC"] = 1] = "MONOTONIC";
    ClockId[ClockId["PROCESS_CPUTIME_ID"] = 2] = "PROCESS_CPUTIME_ID";
    ClockId[ClockId["THREAD_CPUTIME_ID"] = 3] = "THREAD_CPUTIME_ID";
})(ClockId || (ClockId = {}));
const p = (globalThis.performance);
export function clock_time_get(clk_id, _precision, outPtr) {
    let nowMs;
    switch (clk_id) {
        case ClockId.REALTIME:
            nowMs = Date.now();
            break;
        case ClockId.MONOTONIC:
            if (p == null)
                return ENOSYS; // TODO: Possible to be null in Worklets?
            nowMs = p.now();
            break;
        case ClockId.PROCESS_CPUTIME_ID:
        case ClockId.THREAD_CPUTIME_ID:
            return ENOSYS;
        default: return EINVAL;
    }
    const nowNs = BigInt(Math.round(nowMs * 1000 * 1000));
    writeUint64(this, outPtr, nowNs);
    return ESUCCESS;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xvY2tfdGltZV9nZXQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvd2FzaV9zbmFwc2hvdF9wcmV2aWV3MS9jbG9ja190aW1lX2dldC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsTUFBTSxhQUFhLENBQUM7QUFDdkQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBQ3RELE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLFlBQVksQ0FBQztBQUU5QyxNQUFNLENBQU4sSUFBWSxPQUtYO0FBTEQsV0FBWSxPQUFPO0lBQ2YsNkNBQVksQ0FBQTtJQUNaLCtDQUFhLENBQUE7SUFDYixpRUFBc0IsQ0FBQTtJQUN0QiwrREFBcUIsQ0FBQTtBQUN6QixDQUFDLEVBTFcsT0FBTyxLQUFQLE9BQU8sUUFLbEI7QUFFRCxNQUFNLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUVuQyxNQUFNLFVBQVUsY0FBYyxDQUF5QixNQUFjLEVBQUUsVUFBa0IsRUFBRSxNQUFjO0lBRXJHLElBQUksS0FBYSxDQUFDO0lBQ2xCLFFBQVEsTUFBTSxFQUFFLENBQUM7UUFDYixLQUFLLE9BQU8sQ0FBQyxRQUFRO1lBQ2pCLEtBQUssR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7WUFDbkIsTUFBTTtRQUNWLEtBQUssT0FBTyxDQUFDLFNBQVM7WUFDbEIsSUFBSSxDQUFDLElBQUksSUFBSTtnQkFBRSxPQUFPLE1BQU0sQ0FBQyxDQUFHLHlDQUF5QztZQUN6RSxLQUFLLEdBQUcsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDO1lBQ2hCLE1BQU07UUFDVixLQUFLLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQztRQUNoQyxLQUFLLE9BQU8sQ0FBQyxpQkFBaUI7WUFDMUIsT0FBTyxNQUFNLENBQUM7UUFDbEIsT0FBTyxDQUFDLENBQUMsT0FBTyxNQUFNLENBQUM7SUFDM0IsQ0FBQztJQUNELE1BQU0sS0FBSyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxJQUFJLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUN0RCxXQUFXLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxLQUFLLENBQUMsQ0FBQztJQUVqQyxPQUFPLFFBQVEsQ0FBQztBQUNwQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRUlOVkFMLCBFTk9TWVMsIEVTVUNDRVNTIH0gZnJvbSBcIi4uL2Vycm5vLmpzXCI7XHJcbmltcG9ydCB7IHdyaXRlVWludDY0IH0gZnJvbSBcIi4uL3V0aWwvd3JpdGUtdWludDY0LmpzXCI7XHJcbmltcG9ydCB7IEluc3RhbnRpYXRlZFdhc20gfSBmcm9tIFwiLi4vd2FzbS5qc1wiO1xyXG5cclxuZXhwb3J0IGVudW0gQ2xvY2tJZCB7XHJcbiAgICBSRUFMVElNRSA9IDAsXHJcbiAgICBNT05PVE9OSUMgPSAxLFxyXG4gICAgUFJPQ0VTU19DUFVUSU1FX0lEID0gMixcclxuICAgIFRIUkVBRF9DUFVUSU1FX0lEID0gM1xyXG59XHJcblxyXG5jb25zdCBwID0gKGdsb2JhbFRoaXMucGVyZm9ybWFuY2UpO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNsb2NrX3RpbWVfZ2V0KHRoaXM6IEluc3RhbnRpYXRlZFdhc20sIGNsa19pZDogbnVtYmVyLCBfcHJlY2lzaW9uOiBudW1iZXIsIG91dFB0cjogbnVtYmVyKTogbnVtYmVyIHtcclxuXHJcbiAgICBsZXQgbm93TXM6IG51bWJlcjtcclxuICAgIHN3aXRjaCAoY2xrX2lkKSB7XHJcbiAgICAgICAgY2FzZSBDbG9ja0lkLlJFQUxUSU1FOlxyXG4gICAgICAgICAgICBub3dNcyA9IERhdGUubm93KCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgQ2xvY2tJZC5NT05PVE9OSUM6XHJcbiAgICAgICAgICAgIGlmIChwID09IG51bGwpIHJldHVybiBFTk9TWVM7ICAgLy8gVE9ETzogUG9zc2libGUgdG8gYmUgbnVsbCBpbiBXb3JrbGV0cz9cclxuICAgICAgICAgICAgbm93TXMgPSBwLm5vdygpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIENsb2NrSWQuUFJPQ0VTU19DUFVUSU1FX0lEOlxyXG4gICAgICAgIGNhc2UgQ2xvY2tJZC5USFJFQURfQ1BVVElNRV9JRDpcclxuICAgICAgICAgICAgcmV0dXJuIEVOT1NZUztcclxuICAgICAgICBkZWZhdWx0OiByZXR1cm4gRUlOVkFMO1xyXG4gICAgfVxyXG4gICAgY29uc3Qgbm93TnMgPSBCaWdJbnQoTWF0aC5yb3VuZChub3dNcyAqIDEwMDAgKiAxMDAwKSk7XHJcbiAgICB3cml0ZVVpbnQ2NCh0aGlzLCBvdXRQdHIsIG5vd05zKTtcclxuXHJcbiAgICByZXR1cm4gRVNVQ0NFU1M7XHJcbn0iXX0=